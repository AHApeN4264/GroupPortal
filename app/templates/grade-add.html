{% extends 'base.html' %}
{% load static %}

{% block title %}
<title>–®–∫—ñ–ª—å–Ω–∏–π —Å–∞–π—Ç ‚Äî –û—Ü—ñ–Ω–∫–∏</title>
<style>
  body {
    font-family: "Segoe UI", Roboto, Arial, sans-serif;
    margin: 0;
    padding: 0;
    background-color: #f4f4f9;
  }

  .table-hover tbody tr:hover {
    background-color: #f1f5ff; 
  }

  .message { 
    color: green; 
  }

  .error-msg { 
    color: red; 
  }
</style>
{% endblock %}

{% block body %}
<main>
  <div class="card shadow-sm">
    <div class="card-body">

      {% if messages %}
        {% for message in messages %}
          <p class="{% if message.tags == 'success' %}message{% else %}error-msg{% endif %}">
            {{ message }}
          </p>
        {% endfor %}
      {% endif %}

      <div class="table-responsive mb-3">
        <table class="table table-hover mb-0">
          <thead class="table-secondary">
            <tr>
              <th style="width:60px;">#</th>
              <th>–£—á–µ–Ω—å</th>
              <th>–ö–ª–∞—Å</th>
              <th>–ü—Ä–µ–¥–º–µ—Ç</th>
              <th style="width:120px;">–û—Ü—ñ–Ω–∫–∞</th>
              <th style="width:160px;">–î–∞—Ç–∞</th>
              <th style="width:220px;">–î—ñ—è</th>
            </tr>
          </thead>
          <tbody>
          {% for g in grades %}
            <tr>
              <td>{{ forloop.counter }}</td>
              <td>{{ g.student_name }}</td>
              <td>{{ g.student_class|default:"‚Äî" }}</td>
              <td>{{ g.subject|default:"‚Äî" }}</td>
              <td class="fw-bold">{{ g.grade }}</td>
              <td>{{ g.created_at|date:"Y-m-d H:i" }}</td>
              <td>
                <a href="{% url 'grade_edit' g.pk %}" class="btn btn-sm btn-outline-warning me-1">‚úèÔ∏è –†–µ–¥–∞–≥—É–≤–∞—Ç–∏</a>
              
                {% if role == "–ú–æ–¥–µ—Ä–∞—Ç–æ—Ä" or role == "–ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä" %}
                <form method="post" action="{% url 'grade_delete' g.pk %}" style="display:inline-block"
                      onsubmit="return confirm('–í–∏ –¥—ñ–π—Å–Ω–æ —Ö–æ—á–µ—Ç–µ –≤–∏–¥–∞–ª–∏—Ç–∏ —Ü—å–æ–≥–æ —É—á–Ω—è?');">
                  {% csrf_token %}
                  <button type="submit" class="btn btn-sm btn-outline-danger">üóë –í–∏–¥–∞–ª–∏—Ç–∏</button>
                </form>
                {% endif %}
              
              </td>
            </tr>
          {% empty %}
            <tr>
              <td colspan="7" class="text-center py-4 text-muted">–£—á–Ω—ñ–≤ —â–µ –Ω–µ–º–∞—î.</td>
            </tr>
          {% endfor %}
        </tbody>
        </table>
      </div>

      {% if role == "–ú–æ–¥–µ—Ä–∞—Ç–æ—Ä" or role == "–ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä" %}
      <div class="text-end mt-4">
        <form method="post">
          {% csrf_token %}
          <button type="submit" name="add_student" class="btn btn-primary">
            + –î–æ–¥–∞—Ç–∏ —É—á–Ω—è
          </button>
        </form>
      </div>
      {% endif %}

    </div>
  </div>
</main>
{% endblock %}
