{% extends 'base.html' %}
{% load static %}

{% block title %}
<title>Шкільний сайт — Оцінки</title>
<style>
body {
  font-family: "Segoe UI", Roboto, Arial, sans-serif;
  margin: 0;
  padding: 0;
  background-color: #f4f4f9;
}

.table-hover tbody tr:hover { 
  background-color: #f1f5ff; 
}

table thead tr {
  border-bottom: 2px solid #dee2e6;
}

/* Убираем отступы слева и справа */
.card-body, .table-responsive {
  padding-left: 0 !important;
  padding-right: 0 !important;
}
</style>
{% endblock %}

{% block body %}
{% if messages %}
  {% for message in messages %}
    <p class="{% if message.tags == 'success' %}message{% else %}error-msg{% endif %}">
      {{ message }}
    </p>
  {% endfor %}
{% endif %}

<main>
  <div class="card shadow-sm">
    <div class="card-body">

      <div class="table-responsive">
        <table class="table table-hover mb-0">
          <thead class="table-secondary">
            <tr>
              <th style="width:60px;">#</th>
              <th>Учень</th>
              <th>Клас</th>
              <th>Предмет</th>
              <th style="width:120px;">Оцінка</th>
              <th style="width:160px;">Дата</th>
            </tr>
          </thead>
          <tbody>
          {% for g in grades %}
          <tr style="height: 35px;">
            <td style="padding: 0.47rem 0.5rem;">{{ forloop.counter }}</td>
            <td style="padding: 0.47rem 0.5rem;">{{ g.student_name }}</td>
            <td style="padding: 0.47rem 0.5rem;">{{ g.student_class|default:"—" }}</td>
            <td style="padding: 0.47rem 0.5rem;">{{ g.subject|default:"—" }}</td>
            <td style="padding: 0.47rem 0.5rem;" class="fw-bold">{{ g.grade }}</td>
            <td style="padding: 0.47rem 0.5rem;">{{ g.created_at|date:"Y-m-d H:i" }}</td>
          </tr>
          {% empty %}
          <tr>
            <td colspan="7" class="text-center py-3 text-muted">Учнів ще немає.</td>
          </tr>
          {% endfor %}
          </tbody>
        </table>
      </div>

      {% if role == "Модератор" or role == "Адміністратор" %}
        <div class="mb-3 text-end">
          <a href="{% url 'grade-add' %}" class="btn btn-success">
            Редагувати учнів
          </a>
        </div>
      {% endif %}

      <nav aria-label="Page navigation">
        <ul class="pagination justify-content-center">
          {% if grades.has_previous %}
            <li class="page-item">
              <a class="page-link" href="?page={{ grades.previous_page_number }}">Назад</a>
            </li>
          {% else %}
            <li class="page-item disabled"><span class="page-link">Назад</span></li>
          {% endif %}

          {% for num in grades.paginator.page_range %}
            {% if grades.number == num %}
              <li class="page-item active"><span class="page-link">{{ num }}</span></li>
            {% else %}
              <li class="page-item"><a class="page-link" href="?page={{ num }}">{{ num }}</a></li>
            {% endif %}
          {% endfor %}

          {% if grades.has_next %}
            <li class="page-item">
              <a class="page-link" href="?page={{ grades.next_page_number }}">Вперед</a>
            </li>
          {% else %}
            <li class="page-item disabled"><span class="page-link">Вперед</span></li>
          {% endif %}
        </ul>
      </nav>

    </div>
  </div>
</main>

{% endblock %}
